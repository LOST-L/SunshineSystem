package com.heli.oa.common.service.impl;

import com.heli.oa.common.dao.RolePermissionDao;
import com.heli.oa.common.entity.Permission;
import com.heli.oa.common.entity.Role;
import com.heli.oa.common.service.RolePermissionService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.HashSet;
import java.util.List;
import java.util.Set;
/**
 *@Author: 白驹
 *@Date: 2019/1/2 10:42
 *@Description: shiro 自定义realm service
 */
@Service
public class RolePermissionServiceImpl implements RolePermissionService {

    @Autowired
    RolePermissionDao rolePermissionDao;

    @Override
    public Set<String> listRoles(String userNickName) {
        List<Role> roles = rolePermissionDao.listRolesByUserName(userNickName);
        Set<String> result = new HashSet<>();

        for (int i = 0; i <roles.size() ; i++) {
            result.add(roles.get(i).getRoleName());
        }
        return result;
    }

    @Override
    public Set<String> listPermissions(String userNickName) {
        List<Permission> permissions = rolePermissionDao.listPermissionsByUserName(userNickName);
        Set<String> result = new HashSet<>();
        for (Permission permission: permissions) {
            result.add(permission.getPerName());
        }
        return result;
    }
}

